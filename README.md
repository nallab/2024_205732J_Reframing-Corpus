# タイトル
リフレーミング可能な対話モデル構築に向けたコーパス設計とモデル試作

# 要旨
カウンセラーが多用する対話技術にリフレーミングがある。リフレーミングとは、ある枠組みで捉えられている物事に対して、違う枠組みで捉え直すことを指す。ネガティブな相談内容にポジティブなリフレーミングを適用させることで、相談者の自己肯定感の向上が期待できる。このようなネガティブ発話をポジティブに言い換えるような能力を対話モデルに学習させることで、手軽なカウンセリング体験を提供できると考えた。

そこで本研究では、ChatGPT（GPT4-Turbo）を利用してネガティブ発話とポジティブ返答をペアとしたリフレーミングコーパスを作成し、大規模言語モデルにファインチューニングすることで、ユーザーのネガティブ発話をポジティブな表現に言い換えることができる社会性を備えた対話モデルの構築を目指した。

# 卒論ページ
https://ie.u-ryukyu.ac.jp/dissertation_test/dissertation/e205732/

# Corpusディレクトリ
本研究で構築したリフレーミングコーパスとその分析のためのNoteBookファイルが存在する。NoteBookファイルにおける`コーパス読み込み`というセクションでは各自実行環境に合わせてパスを変更すること。

### リフレーミングコーパス
リフレーミングコーパスは相談者役Aのネガティブ発話とカウンセラー役Bのポジティブ返答のペアで構成される。
ChatGPT (GPT4-Turbo) を利用してリフレーミング事例を収集した。
現状1,000ペアで構成される。

### 設計手順
1. ChatGPTに相談者役Aのペルソナを250人生成してもらう。
   - ペルソナ情報は、名前、年齢、性別、出身地、身長、体重、性格、趣味、職業または学年、家庭の経済状況、両親の有無、配偶者の有無、子供の有無、友人関係の14項目を含む。
2. ペルソナ情報を入力として与え、1人に対して4つのトピックに関するネガティブ発話を生成してもらう。
   - トピックは、生活全般に関する悩み、職場または学業に関する悩み、家族または恋愛に関する悩み、自己評価に関する悩みの4つ。
3. ネガティブ発話を入力として与え、ポジティブ返答を生成してもらう。
4. ネガティブ発話とポジティブ返答の校閲をする。

### リフレーミングコーパスの分析
ペルソナはユニークな名前の男性124人、女性126人で構成され、幅広い年齢層をカバーしている。
リフレーミングコーパスはユニークな言い換えペア1,000件で構成されており、それはネガティブ発話が全てユニークであることに起因している。
しかし、実際のところ主語や言い回しの違いによってユニークなものになっているだけで、内容的には同じものが多くある。
ネガティブ発話及びポジティブ返答における様々な状況や文脈を考慮した多様性や、内容のバランスが課題である。

# NoteBooksディレクトリ
[japanese-gpt2-small](https://huggingface.co/rinna/japanese-gpt2-small)と[t5-base-japanese](https://huggingface.co/sonoisa/t5-base-japanese)をリフレーミングコーパスでファインチューニングし、自動評価を行うためのNoteBookファイルが存在する。両ファイルとも`データの準備`というセクションでは各自実行環境に合わせてパスを変更すること。

# 実行環境
NoteBookファイルをGoogle Colaboratoryにて実行する。